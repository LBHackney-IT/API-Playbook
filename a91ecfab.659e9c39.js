(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{108:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return i})),n.d(t,"default",(function(){return l}));var a=n(3),r=n(7),o=(n(0),n(137)),c={id:"mock_unit_tests",title:"Isolating Unit Tests"},s={unversionedId:"mock_unit_tests",id:"mock_unit_tests",isDocsHomePage:!1,title:"Isolating Unit Tests",description:"Introduction",source:"@site/docs/mock_unit_tests.md",slug:"/mock_unit_tests",permalink:"/API-Playbook/mock_unit_tests",editUrl:"https://github.com/LBHackney-IT/API-Playbook/edit/master/docs/mock_unit_tests.md",version:"current",sidebar:"docs",previous:{title:"Writing Unit Tests",permalink:"/API-Playbook/unit_testing"},next:{title:"How to write integration tests",permalink:"/API-Playbook/integration_tests"}},i=[{value:"Introduction",id:"introduction",children:[]},{value:"Setting up and using mocks",id:"setting-up-and-using-mocks",children:[]}],u={toc:i};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"introduction"},"Introduction"),Object(o.b)("p",null,"Unit tests are used to test the functionality of a class in isolation.\nSo if a class depends on another we will need to mock any interactions with that class. We are using ",Object(o.b)("u",null," dependency injection "),"  so any class which needs to interact with another will be passed an interface, which the depended on class subscribes to, in the constructor.\nIn the tests, we can then just pass in a mock implementation of this interface into the constructor instead."),Object(o.b)("p",null,"Read some advice for mocking and writing unit tests in the ",Object(o.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/dotnet/core/testing/unit-testing-best-practices"},".NET documentation"),"."),Object(o.b)("h2",{id:"setting-up-and-using-mocks"},"Setting up and using mocks"),Object(o.b)("p",null,"You can use mocks to return a specific value for a given input. For example a test for the following code:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-dotnet"},"public class GetSomeData\n{\n  public IAccessDataStore _datastore;\n\n  public GetSomeData(IAccessDataStore dataStore)\n  {\n    _datastore = dataStore;\n  }\n\n  public SomeData Execure(int id)\n  {\n    return _dataStore.Get(id);\n  }\n}\n")),Object(o.b)("p",null,"might look like.."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-dotnet"},'public class GetSomeDataTests\n{\n  [Test]\n  public void ExecuteReturnsTheDataFromTheDataStore()\n  {\n    //Arrange\n    var mock = new Mock<IAccessDataStore>();\n    var stubData = new SomeData{ fieldOne: "data", fieldTwo: 7 };\n    var id = 89;\n    mock.SetUp(x => x.Get(89)).Returns(stubData);\n\n    //Act\n    var classUnderTest = new GetSomeData(mock.Object);\n    var returnedData = classUnderTest.Execute(89);\n\n    //Assert\n    returnedData.Should().BeEquivalentTo(stubData);\n  }\n}\n')),Object(o.b)("p",null,"Or you can assert that they were called with the correct inputs. For example a test for the following code.."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-dotnet"},"public class SaveSomeData\n{\n  public IAccessDataStore _datastore;\n\n  public SaveSomeData(IAccessDataStore dataStore)\n  {\n    _datastore dataStore;\n  }\n\n  public void Execute(SomeData data)\n  {\n    return _dataStore. Put(data);\n  }\n}\n")),Object(o.b)("p",null,"might look like.."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-dotnet"},'public class SaveSomeDataTests\n{\n  [Test]\n  public void ExecutePutsTheDataInto TheDataStore()\n  {\n    //Arrange\n    var mock = new Mock<IAccessDataStore>();\n    var dataToSave = new SomeData{ fieldOne: "data", fieldTwo: 7 };\n\n    //Act\n    var classUnderTest = new SaveSomeData(mock. Object);\n    classUnderTest.Execute(89);\n    \n    //Assert\n    mock. Verify(x => x.Put(dataToSave), Times.Once());\n  }\n}\n')),Object(o.b)("p",null,"These examples are just a couple of common use cases for using Moq. Check out the ",Object(o.b)("a",{parentName:"p",href:"https://github.com/Moq/moq4/wiki/Quickstart"},"moq documentation")," for more examples and use cases!"))}l.isMDXComponent=!0},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=r.a.createContext({}),l=function(e){var t=r.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=l(e.components);return r.a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=l(n),m=a,b=p["".concat(c,".").concat(m)]||p[m]||d[m]||o;return n?r.a.createElement(b,s(s({ref:t},u),{},{components:n})):r.a.createElement(b,s({ref:t},u))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,c=new Array(o);c[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,c[1]=s;for(var u=2;u<o;u++)c[u]=n[u];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);