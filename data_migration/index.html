<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/API-Playbook/blog/rss.xml" title="Hackney API Playbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/API-Playbook/blog/atom.xml" title="Hackney API Playbook Blog Atom Feed"><title data-react-helmet="true">Data Migration Playbook | Hackney API Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Data Migration Playbook | Hackney API Playbook"><meta data-react-helmet="true" name="description" content="Data migration: How-to guide"><meta data-react-helmet="true" property="og:description" content="Data migration: How-to guide"><meta data-react-helmet="true" property="og:url" content="https://lbhackney-it.github.io/API-Playbook/API-Playbook/data_migration"><link data-react-helmet="true" rel="shortcut icon" href="/API-Playbook/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://lbhackney-it.github.io/API-Playbook/API-Playbook/data_migration"><link rel="stylesheet" href="/API-Playbook/styles.ed6e5456.css">
<link rel="stylesheet" href="/API-Playbook/main.de1e1e2a.css">
<link rel="preload" href="/API-Playbook/styles.a819b783.js" as="script">
<link rel="preload" href="/API-Playbook/runtime~main.9f3a47bb.js" as="script">
<link rel="preload" href="/API-Playbook/main.3b2af75d.js" as="script">
<link rel="preload" href="/API-Playbook/1.70f1d937.js" as="script">
<link rel="preload" href="/API-Playbook/2.78ecfad1.js" as="script">
<link rel="preload" href="/API-Playbook/39.b508b609.js" as="script">
<link rel="preload" href="/API-Playbook/935f2afb.57b1de5c.js" as="script">
<link rel="preload" href="/API-Playbook/17896441.eb47fd90.js" as="script">
<link rel="preload" href="/API-Playbook/0c32673a.2b02b168.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/API-Playbook/"><img src="/API-Playbook/img/logo-long.svg" alt="API Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/API-Playbook/img/logo-long.svg" alt="API Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">API Playbook</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/API-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/API-Playbook/"><img src="/API-Playbook/img/logo-long.svg" alt="API Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/API-Playbook/img/logo-long.svg" alt="API Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">API Playbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/API-Playbook" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Home</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/api_standards">API Standards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/platform_api_vs_service_api">Platform API vs Service API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/documentation">API Documentation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Development Process</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Designing your API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/api_design_principles">API Design Principles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/api_implementation_guidelines">API Implementation Guidelines</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/naming_conventions">Naming Conventions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/branching_strategy">Branching Strategy</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">API Practices and Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/linting">Linting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/static_code_analysis">Static Code Analysis Tools Spike Notes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">DevOps Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/deployment_pipeline">Deployment Pipeline</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/infrastructure">Infrastucture as Code</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">How to build an API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/preferred_tech_stack">Preferred Tech Stack</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/api_boilerplate">API Boilerplate - Base API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Testing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/tdd">Good TDD Principles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/unit_test">Writing Unit Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/integration_tests">How to write integration tests</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Deploying your API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/aws_ecs">AWS / ECS with Fargate and when to use</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/lambda_best_practices">Lambda Functions Use and Good Practice</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/centralised_logging">Centralised Logging and Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/uptime_monitoring">Uptime Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/alerting">Alerting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/serverless_lambda">Serverless Lambda Framework</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Securing your API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/api_keys">API Keys</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Lambda authoriser</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/API-Playbook/generating_tokens">Generating Tokens</a></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Other Useful Information</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/API-Playbook/rds_access">Access to RDS in a private subnet from local machine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/API-Playbook/ec2_access">Access to EC2 in a private subnet from local machine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/API-Playbook/postgresql">Creating users in PostgreSQL</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/API-Playbook/data_migration">Data Migration Playbook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/API-Playbook/contact_us">Contact The Hackney API Team</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Data Migration Playbook</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="data-migration-how-to-guide"></a>Data migration: How-to guide<a class="hash-link" href="#data-migration-how-to-guide" title="Direct link to heading">#</a></h2><p>Data migration using AWS DMS.......................................................................... 1</p><p>What is AWS DMS  .............................................................................................. 1</p><p>Which AWS DMS set up to use?......................................................................... 2</p><p>For continuous migration......................................................................................2</p><p>CDC......................................................................................................................2</p><p>Use case...............................................................................................................2</p><p>MS Replication......................................................................................................2</p><p>Use cases..............................................................................................................2</p><p>For one-off set up...................................................................................................2</p><p>Use cases...............................................................................................................3</p><p>How to set DMS up.................................................................................................3</p><p>Database set up......................................................................................................3</p><p>DMS with SQL CDC................................................................................................3</p><p>DMS with MS Replication........................................................................................3</p><p>AWS DMS set up via Terraform ..............................................................................3</p><p>DMS.........................................................................................................................3</p><p>Postgres...................................................................................................................4</p><p>Data migration using a data pipeline........................................................................5</p><p>What is a data pipeline?............................................................................................5</p><p>Data pipeline - csv to Postgres .................................................................................5</p><p>Pipeline implementation	............................................................................................6</p><p>S3...............................................................................................................................6</p><p>Lambda...................................................................................................................... 7</p><p>How to set up the data pipeline for a project	..............................................................7</p><p>Notes	 .......................................................................................................................... 8</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="data-migration-using-aws-dms"></a>Data migration using AWS DMS<a class="hash-link" href="#data-migration-using-aws-dms" title="Direct link to heading">#</a></h2><p><strong> What is AWS DMS? </strong>
AWS Data Migration Service (DMS) is a service that allows us to migrate data between a source (in our case, on-premises database) and a target (in our case, Postgres database hosted in AWS).</p><p><strong> DMS supported replication types: </strong></p><u> 1. Continuous replication (CDC) </u><p>  a. When we want to do a one-off migration of all data and then continuously capture new inserts, updates and deletes and reflect them in our target database</p><u> 2. One-off data migration </u><p>  b. When the goal is to migrate all data from a source, and is expected that changes will not be captured and reflected</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="which-aws-dms-set-up-to-use"></a>Which AWS DMS set up to use?<a class="hash-link" href="#which-aws-dms-set-up-to-use" title="Direct link to heading">#</a></h2><p><strong>  <u> For continuous migration: </u> </strong></p><p><strong>  CDC </strong></p><p>  a. CDC is a SQL server feature, available only on Enterprise and Developer editions</p><p>  b. It allows for changes to be captured (inserts/updates/deletes)</p><p><strong>  Use case </strong></p><ol><li>When the source database does not have primary keys and you want to migrate data continuously.</li></ol><p><strong>   MS Replication </strong></p><p>  c. MS Replication is a SQL server feature available on all editions</p><p>  d. It creates a ‚Äúdistribution‚Äù database and every time there is a change, it is captured and stored in the ‚Äúdistribution‚Äù database</p><p>  e. DMS will then read from that database to reflect the changes in the target database</p><p><strong>  f.NB! </strong> The sql user created must have <strong> sysadmin </strong> permissions to set up replication</p><p>  g. <u> Additional notes: </u> Configuration on the source database is required (please see below section). Additionally, SQL servers DO NOT come with MS replication
features pre-installed, so the server might require a set up.</p><p><strong>  Use cases </strong></p><ol><li><p>When you want to migrate data continuously</p></li><li><p>When the SQL server is not Enterprise/Developer edition</p></li><li><p>When the source database has tables, which make use of primary keys</p></li></ol><p><strong>  For one-off set up </strong></p><ul><li><p>No database configuration is required</p></li><li><p>The sql user must have at least db_owner permissions</p></li><li><p>The replication runs ones and migrates the data specified</p></li><li><p>There are no subsequent runs of the migration task, unless triggered with other means</p></li></ul><p><strong>  Use cases </strong></p><ol><li><p>When only a one-off migration is required</p></li><li><p>When the underlying source database is a reporting server and there are no possible ways to capture updates. In this scenario, we need to daily run a one-off migration, after the reporting server was updated with the latest data</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-to-set-dms-up"></a>How to set DMS up<a class="hash-link" href="#how-to-set-dms-up" title="Direct link to heading">#</a></h2><p><strong> Database set up  </strong></p><p> DMS with SQL CDC</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    https://docs.google.com/document/d/1EaZ-a8ejQwWQ40OGDGobxhTqtxXvtX9Ydk5mTFASUMo/edit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>DMS with MS Replication</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    https://docs.google.com/document/d/14kNirloRWXCnla08brXiTihCMIm24chygc1lGUjNVbE/edit?usp=sharing</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>AWS DMS set up via Terraform</p><p>Both DMS and Postgres can be created via Terraform.</p><p><strong> DMS </strong></p><p>Template repository and example usage:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    https://github.com/LBHackney-IT/aws-dms-terraform</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="alt text" src="/API-Playbook/assets/images/data_migration-d99e1aff824dc152a3e74a2cdeb92f16.png"></p><p><strong>  NB: </strong></p><p>  a. Follow the example usage, which also demonstrates how to add table mappings (specifying which tables are to be replicated)</p><p>  b. The source DB server should be specified with IP and not the server name</p><p>  c. DMS instance should be in the VPC, where the VPN is set up to ensure communication to on-prem is possible</p><p>  d. <u>  Make sure your DMS instance‚Äôs subnet group has only private subnets in it! </u></p><p><strong>  Postgres </strong></p><p>  Template repository and example usage:
<a href="https://github.com/LBHackney-IT/aws-hackney-common-terraform/tree/master/modules/database/postgres" target="_blank" rel="noopener noreferrer">https://github.com/LBHackney-IT/aws-hackney-common-terraform/tree/master/modules/database/postgres</a></p><p><img alt="alt text" src="/API-Playbook/assets/images/data2-95eb403cb5525375efea31272715cea1.png"></p><p><strong> NB: </strong></p><ul><li>DMS does not support Postgres version 12, so use version 11 or older.</li><li>Always store passwords in parameter store and do not hardcode them</li><li>‚ÄúMulti_az‚Äù should be true for production databases</li><li>‚Äúsubnet_ids‚Äù requires subnets in 2 different AZs. Make sure those are private subnets to ensure that the database is secure.</li><li>Currently not terraformed: To enable traffic from DMS to your Postgres instance, ensure you add to the ingress rules of the database‚Äôs security group all traffic   from DMS security group.</li></ul><p><img alt="alt text" src="/API-Playbook/assets/images/data3-f9c9181447b7fa7ea9b1c5c53f6bf365.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="data-migration-using-a-data-pipeline"></a>Data migration using a data pipeline<a class="hash-link" href="#data-migration-using-a-data-pipeline" title="Direct link to heading">#</a></h2><p>  <strong>    What is a data pipeline? </strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  A data pipeline is an automated flow that gets data stored in one location (source) and uploads it to a target destination.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>  <strong>      Data pipeline - csv to Postgres </strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  As of 26/06/2020, we have implemented one data pipeline.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  The pipeline takes data uploaded in an S3 bucket in .csv format and uploads the data into a Postgres database.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>  <img alt="alt text" src="/API-Playbook/assets/images/data4-da7082192e5e80119a19ddec3adf760a.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pipeline-implementation"></a>Pipeline implementation<a class="hash-link" href="#pipeline-implementation" title="Direct link to heading">#</a></h2><p>  <strong> S3 </strong></p><p>  The source S3 bucket has been configured to invoke a Lambda function when a file has been uploaded with extension .csv</p><p><img alt="alt text" src="/API-Playbook/assets/images/data5-6dab3a804826e71d6e6f60056bbc48ff.png"></p><p>The configuration for the source S3 bucket is done using the pipeline‚Äôs serverless implementation - <u> no manual set up is required for events </u> .</p><p>  <img alt="alt text" src="/API-Playbook/assets/images/data6-da5c96d6aad4d03e8ff6fce6b3c042d2.png"></p><p>  <strong> Lambda </strong></p><p>   The lambda function implements the following:</p><ul><li><p>Receives S3 notifications</p></li><li><p>Retrieves bucket and file details from the notification</p></li><li><p>Truncates the target table in the target database</p></li><li><p>Makes use of AWS Postgres function that copies data from an csv file in S3 to Postgres to migrate the data</p></li><li><p>Logs any exceptions and errors to Cloudwatch</p><p><strong> Note: The Postgres database and table to match the CSV format needs to be created separately. </strong></p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-to-set-up-the-data-pipeline-for-a-project"></a>How to set up the data pipeline for a project<a class="hash-link" href="#how-to-set-up-the-data-pipeline-for-a-project" title="Direct link to heading">#</a></h2><p> A template repository has been created for the data pipeline code implementation:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">        https://github.com/LBHackney-IT/s3-to-postgres-data-pipeline</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol><li>Create a repository for your pipeline by using the above template</li><li>Update the code by replacing the names of the existing pipeline to the name of your project‚Äôs pipeline</li><li>Ensure you populate the specified environment variables in the README file of the repository</li><li>Deploy using serverless - this will deploy the Lambda and it will set up an existing S3 bucket with the event it needs to listen for.</li></ol><p><strong> Notes </strong></p><ol><li>You need to create the S3 bucket separately and provide the name in the serverless.yml file of the pipeline repository.</li><li>You need to create the Postgres separately and create the table that will be the ‚Äútarget‚Äù with the same columns as the ones expected to be present in the .csv that will be uploaded to S3</li></ol><p><strong>  Matt notes to be tidied up: </strong></p><ul><li>Add the extension to the database: CREATE EXTENSION IF NOT EXISTS aws_s3 CASCADE;</li><li>RDS needs permissions to access the S3 bucket - GetObject and ListBucket.</li><li>Policy created and role added then added that role to the RDS instance‚Ä¶.(Manually at the moment - how to automate?)</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/API-Playbook/edit/master/docs/data_migration.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/API-Playbook/postgresql"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Creating users in PostgreSQL</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/API-Playbook/contact_us"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contact The Hackney API Team ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-migration-how-to-guide" class="table-of-contents__link">Data migration: How-to guide</a></li><li><a href="#data-migration-using-aws-dms" class="table-of-contents__link">Data migration using AWS DMS</a></li><li><a href="#which-aws-dms-set-up-to-use" class="table-of-contents__link">Which AWS DMS set up to use?</a></li><li><a href="#how-to-set-dms-up" class="table-of-contents__link">How to set DMS up</a></li><li><a href="#data-migration-using-a-data-pipeline" class="table-of-contents__link">Data migration using a data pipeline</a></li><li><a href="#pipeline-implementation" class="table-of-contents__link">Pipeline implementation</a></li><li><a href="#how-to-set-up-the-data-pipeline-for-a-project" class="table-of-contents__link">How to set up the data pipeline for a project</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/API-Playbook/styles.a819b783.js"></script>
<script src="/API-Playbook/runtime~main.9f3a47bb.js"></script>
<script src="/API-Playbook/main.3b2af75d.js"></script>
<script src="/API-Playbook/1.70f1d937.js"></script>
<script src="/API-Playbook/2.78ecfad1.js"></script>
<script src="/API-Playbook/39.b508b609.js"></script>
<script src="/API-Playbook/935f2afb.57b1de5c.js"></script>
<script src="/API-Playbook/17896441.eb47fd90.js"></script>
<script src="/API-Playbook/0c32673a.2b02b168.js"></script>
</body>
</html>